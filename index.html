<!DOCTYPE html>
<html lang="ja">

<head prefix="og: http://ogp.me/ns# fb: http://ogp.me/ns/fb# article: http://ogp.me/ns/article#">
    <title>Notification Test Page</title>
</head>

<body>
    <button onclick="swTest();">テスト</button>

    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('sw.js').then(function (registration) {
                // 登録成功
                console.log('ServiceWorker の登録に成功しました。スコープ: ', registration.scope);

                (
                    async () => {
                        const activeRegistration = await navigator.serviceWorker.ready;
                        // この段階では、まだcontrollerはnullのため、active.postMessageでメッセージを送信
                        activeRegistration.active.postMessage({ action: 'claim' });
                    }
                )();
            }).catch(function (err) {
                // 登録失敗
                console.log('ServiceWorker の登録に失敗しました。', err);
            });
        }

        function swTest() {
            (
                async () => {
                    const activeRegistration = await navigator.serviceWorker.ready;
                    // この段階では、まだcontrollerはnullのため、active.postMessageでメッセージを送信
                    activeRegistration.active.postMessage({ action: 'test' });
                }
            )();
        };
    </script>
</body>

</html>